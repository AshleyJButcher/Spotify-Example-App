"use strict";(self.webpackChunkjbi=self.webpackChunkjbi||[]).push([[447],{7447:(lt,b,r)=>{r.r(b),r.d(b,{MusicModule:()=>st});var d=r(8184),t=r(5879);let x=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-music"]],decls:1,vars:0,template:function(a,o){1&a&&t._UZ(0,"router-outlet")},dependencies:[d.lC]})}return e})();var v=r(7398),y=r(2181),I=r(4664),J=r(6306),U=r(6232),N=r(3020),S=r(9862);let q=(()=>{class e{constructor(n){this.http=n}fetchAlbumSearchResults(n){return this.http.get("search",{params:{type:"album",q:n}}).pipe((0,v.U)(a=>a.albums.items))}static#t=this.\u0275fac=function(a){return new(a||e)(t.LFG(S.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var p=r(6814),i=r(6223),C=r(2032),Q=r(5592),M=r(9360),Z=r(8251),Y=r(4829),O=r(2737),G=r(2420),j=r(9940),E=r(3620),V=r(3997),A=r(2296),w=r(617),g=r(9157),B=r(1911),X=r(3680);function P(e,s){1&e&&(t.TgZ(0,"mat-hint"),t._uU(1," Pending ..."),t.qZA())}function z(e,s){1&e&&(t.TgZ(0,"mat-error"),t._uU(1,"Field is required"),t.qZA())}function D(e,s){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const n=s.ngIf;t.xp6(1),t.hij(" Minimal length is ",n.requiredLength," ")}}function H(e,s){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const n=s.ngIf;t.xp6(1),t.hij(' Cannot contain "',n.badword,'" ')}}function K(e,s){1&e&&(t.TgZ(0,"div",16)(1,"mat-form-field"),t._UZ(2,"input",17),t.qZA()()),2&e&&t.Q6J("formGroup",s.$implicit)}function R(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",9)(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Type"),t.qZA(),t.TgZ(4,"mat-select",10)(5,"mat-option",11),t._uU(6,"Album"),t.qZA(),t.TgZ(7,"mat-option",12),t._uU(8,"Artsits"),t.qZA()()(),t.TgZ(9,"div",13),t.YNc(10,K,3,1,"div",14),t.TgZ(11,"div")(12,"button",15),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.addMarket())}),t.TgZ(13,"mat-icon"),t._uU(14,"add"),t.qZA()()()(),t.TgZ(15,"pre"),t._uU(16),t.ALo(17,"json"),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(10),t.Q6J("ngForOf",n.markets.controls),t.xp6(6),t.Oqu(t.lcZ(17,2,n.searchForm.value))}}let $=(()=>{class e{set query(n){this.searchForm.get("query")?.setValue(n||"",{emitEvent:!1})}constructor(n){this.bob=n,this.search=new t.vpe,this.openAdvanced=!1,this.asyncCensor=u=>new Q.y(h=>{const ct=setTimeout(()=>{const F="batman",it={censor:{badword:F}},mt=String(u.value).includes(F)?it:null;h.next(mt),h.complete()},1e3);return()=>{clearTimeout(ct)}}),this.searchForm=this.bob.group({query:this.bob.control(this.query||"",{validators:[i.kI.required,i.kI.minLength(3)],asyncValidators:[this.asyncCensor]}),advanced:this.bob.group({type:["album"],markets:this.bob.array([this.bob.group({code:this.bob.control("PL")})])})}),this.markets=this.searchForm.get(["advanced","markets"]);const a=this.searchForm.get("query");a.statusChanges.pipe(function L(...e){const s=(0,j.jO)(e);return(0,M.e)((n,a)=>{const o=e.length,c=new Array(o);let l=e.map(()=>!1),u=!1;for(let m=0;m<o;m++)(0,Y.Xf)(e[m]).subscribe((0,Z.x)(a,h=>{c[m]=h,!u&&!l[m]&&(l[m]=!0,(u=l.every(O.y))&&(l=null))},G.Z));n.subscribe((0,Z.x)(a,m=>{if(u){const h=[m,...c];a.next(s?s(...h):h)}}))})}(a.valueChanges),(0,y.h)(([u,m])=>"VALID"===u),(0,v.U)(([u,m])=>m),(0,E.b)(500),(0,V.x)()).subscribe(this.search)}addMarket(){this.markets.push(new i.cw({code:new i.NI("")}))}submit(){const n=this.searchForm.get("query")?.value;this.search.emit(n)}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(i.j3))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-search-form"]],inputs:{query:"query"},outputs:{search:"search"},decls:17,vars:6,consts:[[3,"formGroup","submit"],[1,"mb-2"],[1,"w-100"],["matInput","","formControlName","query"],["field","matInput"],[4,"ngIf"],["mat-fab","","type","submit",1,"float-end","push-up"],[1,"float-end",3,"click"],["formGroupName","advanced",4,"ngIf"],["formGroupName","advanced"],["formControlName","type"],["value","album"],["value","artists"],["formArrayName","markets",1,"d-flex","flex-column","gap-1"],["class","w-100",3,"formGroup",4,"ngFor","ngForOf"],["mat-fab","","type","button",1,"float-left",3,"click"],[1,"w-100",3,"formGroup"],["type","text","matInput","","formControlName","code"]],template:function(a,o){if(1&a&&(t.TgZ(0,"form",0),t.NdJ("submit",function(){return o.submit()}),t.TgZ(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),t._uU(4,"Search"),t.qZA(),t._UZ(5,"input",3,4),t.YNc(7,P,2,0,"mat-hint",5),t.YNc(8,z,2,0,"mat-error",5),t.YNc(9,D,2,1,"mat-error",5),t.YNc(10,H,2,1,"mat-error",5),t.qZA(),t.TgZ(11,"button",6)(12,"mat-icon"),t._uU(13,"search"),t.qZA()(),t.TgZ(14,"span",7),t.NdJ("click",function(){return o.openAdvanced=!o.openAdvanced}),t._uU(15,"Advanced"),t.qZA()(),t.YNc(16,R,18,4,"div",8),t.qZA()),2&a){const c=t.MAs(6);let l,u;t.Q6J("formGroup",o.searchForm),t.xp6(7),t.Q6J("ngIf",o.searchForm.pending),t.xp6(1),t.Q6J("ngIf",c.ngControl.hasError("required")),t.xp6(1),t.Q6J("ngIf",null==(l=o.searchForm.get("query"))?null:l.getError("minlength")),t.xp6(1),t.Q6J("ngIf",null==(u=o.searchForm.get("query"))?null:u.getError("censor")),t.xp6(6),t.Q6J("ngIf",o.openAdvanced)}},dependencies:[p.sg,p.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,i.x0,i.CE,A.cs,w.Hw,C.Nt,g.KE,g.hX,g.bx,g.TO,B.gD,X.ey,p.Ts],styles:[".push-up[_ngcontent-%COMP%] {\n    margin-top: -3.5rem;\n    margin-right: 2rem;\n  }"]})}return e})();var f=r(5195);function W(e,s){if(1&e&&(t.TgZ(0,"mat-card"),t._UZ(1,"img",1),t.TgZ(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA()(),t.TgZ(5,"mat-card-actions",2)(6,"button",3),t._uU(7,"Details"),t.qZA()()()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("src",n.album.images[0].url,t.LSH),t.xp6(3),t.Oqu(n.album.name)}}let k=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-album-card"]],inputs:{album:"album"},decls:1,vars:1,consts:[[4,"ngIf"],["mat-card-image","",3,"src"],["align","end"],["mat-button",""]],template:function(a,o){1&a&&t.YNc(0,W,8,2,"mat-card",0),2&a&&t.Q6J("ngIf",o.album)},dependencies:[p.O5,A.lW,f.a8,f.hq,f.dk,f.G2,f.n5]})}return e})();function _(e,s){if(1&e&&(t.TgZ(0,"div",2),t._UZ(1,"app-album-card",3),t.qZA()),2&e){const n=s.$implicit;t.xp6(1),t.Q6J("album",n)}}let tt=(()=>{class e{constructor(){this.albums=[]}static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-albums-grid"]],inputs:{albums:"albums"},decls:2,vars:1,consts:[[1,"row","row-cols-1","row-cols-sm-4","g-0"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[3,"album"]],template:function(a,o){1&a&&(t.TgZ(0,"div",0),t.YNc(1,_,2,1,"div",1),t.qZA()),2&a&&(t.xp6(1),t.Q6J("ngForOf",o.albums))},dependencies:[p.sg,k]})}return e})();function et(e,s){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=s.ngIf;t.xp6(1),t.hij(" Found ",n.length," results: ")}}function nt(e,s){if(1&e&&(t.ynx(0),t._UZ(1,"app-albums-grid",4),t.BQk()),2&e){const n=s.ngIf;t.xp6(1),t.Q6J("albums",n)}}let T=(()=>{class e{constructor(n,a,o){this.router=n,this.route=a,this.api=o,this.queryChanges=this.route.queryParamMap.pipe((0,v.U)(c=>c.get("q")),(0,y.h)(c=>null!==c)),this.resultsChange=this.queryChanges.pipe((0,I.w)(c=>this.api.fetchAlbumSearchResults(c).pipe((0,J.K)(l=>U.E))),(0,N.B)())}searchAlbums(n){this.router.navigate([],{queryParams:{q:n},relativeTo:this.route})}static#t=this.\u0275fac=function(a){return new(a||e)(t.Y36(d.F0),t.Y36(d.gz),t.Y36(q))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-album-search-view"]],decls:10,vars:9,consts:[[1,"row"],[1,"col"],[3,"query","search"],[4,"ngIf"],[3,"albums"]],template:function(a,o){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"app-search-form",2),t.NdJ("search",function(l){return o.searchAlbums(l)}),t.ALo(3,"async"),t.qZA()()(),t.TgZ(4,"div",0)(5,"div",1),t.YNc(6,et,2,1,"ng-container",3),t.ALo(7,"async"),t.YNc(8,nt,2,1,"ng-container",3),t.ALo(9,"async"),t.qZA()()),2&a&&(t.xp6(2),t.Q6J("query",t.lcZ(3,3,o.queryChanges)),t.xp6(4),t.Q6J("ngIf",t.lcZ(7,5,o.resultsChange)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,7,o.resultsChange)))},dependencies:[p.O5,$,tt,p.Ov]})}return e})();const at=[{path:"",component:x,children:[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",component:T},{path:"albums/:albumId",component:T}]}];let rt=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[d.Bz.forChild(at),d.Bz]})}return e})();var ot=r(6208);let st=(()=>{class e{static#t=this.\u0275fac=function(a){return new(a||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[ot.m,rt]})}return e})()}}]);